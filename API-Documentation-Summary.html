<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #9CA3AF;
        }
        .font-fira {
            font-family: 'Fira Code', monospace;
        }
        /* For Webkit browsers */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1F2937;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #4B5563;
            border-radius: 20px;
            border: 3px solid #1F2937;
        }
        .method-get { background-color: #22c55e; color: white; }
        .method-post { background-color: #3b82f6; color: white; }
        .method-put { background-color: #f97316; color: white; }
        .method-delete { background-color: #ef4444; color: white; }
        
        .section-open > .section-header > svg {
            transform: rotate(90deg);
        }
    </style>
</head>
<body class="antialiased">
    <div class="relative min-h-screen lg:flex">
        <!-- Sidebar -->
        <aside class="sticky top-0 h-screen bg-gray-900/50 backdrop-blur-sm lg:w-64 lg:flex-shrink-0 lg:border-r lg:border-gray-800 hidden lg:block">
            <div class="h-full p-6">
                <h1 class="text-2xl font-bold text-white mb-8">API Docs</h1>
                <nav class="space-y-2">
                    <a href="#general" class="flex items-center px-4 py-2 text-gray-300 rounded-md hover:bg-gray-700/50 transition-colors">General</a>
                    <a href="#auth" class="flex items-center px-4 py-2 text-gray-300 rounded-md hover:bg-gray-700/50 transition-colors">Authentication</a>
                    <a href="#admin" class="flex items-center px-4 py-2 text-gray-300 rounded-md hover:bg-gray-700/50 transition-colors">Admin API</a>
                    <a href="#coach" class="flex items-center px-4 py-2 text-gray-300 rounded-md hover:bg-gray-700/50 transition-colors">Coach API</a>
                    <a href="#player" class="flex items-center px-4 py-2 text-gray-300 rounded-md hover:bg-gray-700/50 transition-colors">Player API</a>
                </nav>
            </div>
        </aside>

        <!-- Main content -->
        <main class="flex-1 p-4 sm:p-6 lg:p-10">
            <div class="max-w-4xl mx-auto">
                <div class="lg:hidden mb-8">
                    <h1 class="text-3xl font-bold text-white">API Docs</h1>
                    <p class="text-gray-400 mt-2">Yo, here's the consolidated API summary.</p>
                </div>
                
                <!-- General Section -->
                <section id="general" class="mb-12 scroll-mt-24">
                    <h2 class="text-2xl font-bold text-white border-b border-gray-700 pb-2 mb-4">General Info</h2>
                    <div class="space-y-4 text-gray-300">
                        <p>This API is a microservice architecture behind an API Gateway.</p>
                        <p><span class="font-semibold text-white">Base URL:</span> All requests should be made to <code class="bg-gray-800 px-2 py-1 rounded-md text-cyan-400 font-fira">http://localhost:4000</code>.</p>
                        <p><span class="font-semibold text-white">Authentication:</span> Most endpoints are protected and require a JSON Web Token (JWT). You need to include it in the `Authorization` header.</p>
                        <div class="bg-gray-800 rounded-lg p-4 font-fira text-sm">
                            <code class="text-white">Authorization: Bearer &lt;your_jwt_token&gt;</code>
                        </div>
                    </div>
                </section>
                
                <!-- Authentication & Registration -->
                <section id="auth" class="mb-12 scroll-mt-24">
                    <h2 class="text-2xl font-bold text-white border-b border-gray-700 pb-2 mb-4">Authentication & Registration</h2>
                    
                    <!-- Login Endpoint -->
                    <div class="api-section mb-6" data-section="login">
                        <div class="bg-gray-800/50 rounded-lg">
                            <div class="section-header flex justify-between items-center p-4 cursor-pointer" onclick="toggleSection('login')">
                                <div class="flex items-center gap-4">
                                    <span class="method-post font-mono text-sm font-semibold px-2.5 py-0.5 rounded-md">POST</span>
                                    <span class="text-lg font-semibold text-white font-fira">/login</span>
                                </div>
                                <svg class="w-5 h-5 text-gray-400 transition-transform" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
                            </div>
                            <div class="section-content hidden p-4 border-t border-gray-700">
                                <p class="text-gray-300 mb-4">Authenticate a user and get a JWT token (HTML response).</p>
                                <h4 class="font-semibold text-white mb-2">Request Body</h4>
                                <div class="relative">
                                    <pre class="bg-gray-900 rounded-lg p-4 font-fira text-sm text-gray-200 overflow-x-auto"><code class="language-json" id="login-body">{
  "email": "aung.min.coach@vainglory.com",
  "password": "coachpass1"
}</code></pre>
                                    <button onclick="copyToClipboard('login-body')" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs px-2 py-1 rounded">Copy</button>
                                </div>
                                <h4 class="font-semibold text-white mt-4 mb-2">Success Response (HTML)</h4>
                                <pre class="bg-gray-900 rounded-lg p-4 font-fira text-sm text-gray-200 overflow-x-auto">&lt;html&gt;
  ...
  &lt;div&gt;Your JWT Token: <span class="text-cyan-400">&lt;token&gt;</span>&lt;/div&gt;
  ...
&lt;/html&gt;
</pre>
                                <h4 class="font-semibold text-white mt-4 mb-2">Error Responses</h4>
                                <div class="mb-2">
                                    <span class="font-semibold text-red-400">400 Bad Request:</span> Missing email or password.<br>
                                    <code class="bg-gray-800 px-2 py-1 rounded-md text-red-300 font-fira">&lt;html&gt;...Missing email or password...&lt;/html&gt;</code>
                                </div>
                                <div class="mb-2">
                                    <span class="font-semibold text-red-400">401 Unauthorized:</span> Invalid credentials.<br>
                                    <code class="bg-gray-800 px-2 py-1 rounded-md text-red-300 font-fira">&lt;html&gt;...Invalid credentials...&lt;/html&gt;</code>
                                </div>
                                <div>
                                    <span class="font-semibold text-red-400">500 Internal Server Error:</span> Database error.<br>
                                    <code class="bg-gray-800 px-2 py-1 rounded-md text-red-300 font-fira">&lt;html&gt;...Database error...&lt;/html&gt;</code>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Registration Endpoints -->
                    <div class="api-section" data-section="register">
                        <div class="bg-gray-800/50 rounded-lg">
                            <div class="section-header flex justify-between items-center p-4 cursor-pointer" onclick="toggleSection('register')">
                                <div class="flex items-center gap-4">
                                    <span class="method-post font-mono text-sm font-semibold px-2.5 py-0.5 rounded-md">POST</span>
                                    <span class="text-lg font-semibold text-white font-fira">/reg/{role}</span>
                                </div>
                                <svg class="w-5 h-5 text-gray-400 transition-transform" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
                            </div>
                            <div class="section-content hidden p-4 border-t border-gray-700">
                                <p class="text-gray-300 mb-4">Register a new user. Replace <code class="font-fira bg-gray-700 px-1 rounded-sm text-cyan-400">{role}</code> with `coach`, `player`, or `admin`.</p>
                                <h4 class="font-semibold text-white mb-2">Request Body</h4>
                                <div class="relative">
                                    <pre class="bg-gray-900 rounded-lg p-4 font-fira text-sm text-gray-200 overflow-x-auto"><code class="language-json" id="register-body">{
  "firstname": "Somchai Prasert",
  "password": "playerpass1",
  "mobile": "+66812345678"
}</code></pre>
                                    <button onclick="copyToClipboard('register-body')" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs px-2 py-1 rounded">Copy</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- Dynamically Inserted API Sections will go here -->
                <div id="api-sections-container"></div>
            </div>
        </main>
    </div>

    <script>
        const apiData = {
            admin: [
                { method: 'GET', path: '/admin/players', description: 'View all players.' },
                { method: 'GET', path: '/admin/coaches', description: 'View all coaches.' },
                { method: 'GET', path: '/admin/schedules', description: 'View all scheduled matches.' },
                { method: 'DELETE', path: '/admin/user', description: 'Delete user by email.', body: '{ "email": "user@email.com" }' },
                { method: 'PUT', path: '/admin/user/:id', description: 'Update user by custom ID.', body: '{ "name": "New Name" }' },
                { method: 'DELETE', path: '/admin/user/:id', description: 'Delete user by custom ID.' },
                { method: 'PUT', path: '/admin/schedule/:matchId', description: 'Update schedule by matchId.', body: '{ "opponent": "New Team" }' },
                { method: 'DELETE', path: '/admin/schedule/:matchId', description: 'Delete schedule by matchId.' },
                { method: 'PUT', path: '/admin/update-password', description: 'Admin updates their password.', body: '{\n  "email": "admin@email.com",\n  "currentPassword": "old",\n  "newPassword": "new"\n}' },
                { method: 'PUT', path: '/admin/reset-password', description: 'Admin resets password via mobile.', body: '{\n  "email": "admin@email.com",\n  "mobile": "1234567890",\n  "newPassword": "new"\n}' },
                { method: 'GET', path: '/admin/coach-search?email=...', description: 'Search coach by email.' },
                { method: 'GET', path: '/admin/coach-search?id=...', description: 'Search coach by ID.' },
            ],
            coach: [
                { method: 'POST', path: '/coach/schedule', description: 'Create a new match.', body: '{ "opponent": "TeamX", "matchDate": "2025-06-15", "game": "Valorant" }' },
                { method: 'GET', path: '/coach/schedule', description: 'Get all scheduled matches.' },
                { method: 'GET', path: '/coach/schedule/:matchId', description: 'Get details for a specific match.' },
                { method: 'POST', path: '/coach/assignvod', description: 'Assign a VOD to a player.', body: '{ "matchId": 1234, "playerEmail": "player@email.com" }' },
                { method: 'GET', path: '/coach/roster', description: 'Get all registered players.' },
                { method: 'PUT', path: '/coach/update-password', description: 'Coach updates their password.', body: '{\n  "email": "coach@email.com",\n  "currentPassword": "old",\n  "newPassword": "new"\n}' },
                { method: 'PUT', path: '/coach/reset-password', description: 'Coach resets password via mobile.', body: '{\n  "email": "coach@email.com",\n  "mobile": "1234567890",\n  "newPassword": "new"\n}' },
                { method: 'GET', path: '/coach/player-search?email=...', description: 'Search player by email.' },
                { method: 'GET', path: '/coach/player-search?id=...', description: 'Search player by ID.' },
                { method: 'GET', path: '/coach/:matchId', description: 'Get match by matchId.' },
            ],
            player: [
                { method: 'GET', path: '/player/schedules', description: 'Get player\'s match schedules.' },
                { method: 'GET', path: '/player/myvods', description: 'Get player\'s assigned VODs.' },
                { method: 'PUT', path: '/player/reviewvod/:vodId', description: 'Add notes to a VOD review.', body: '{ "notes": "Great play at 10:00" }' },
                { method: 'PUT', path: '/player/update-password', description: 'Player updates their password.', body: '{\n  "email": "player@email.com",\n  "oldPassword": "oldpass",\n  "newPassword": "newpass"\n}' },
                { method: 'PUT', path: '/player/reset-password', description: 'Player resets password via mobile.', body: '{\n  "email": "player@email.com",\n  "mobile": "1234567890",\n  "newPassword": "newpass"\n}' },
                { method: 'GET', path: '/player/:matchId', description: 'Get details for a specific match.' },
            ]
        };

        function createApiSection(id, title, endpoints) {
            const section = document.createElement('section');
            section.id = id;
            section.className = 'mb-12 scroll-mt-24';

            const header = document.createElement('h2');
            header.className = 'text-2xl font-bold text-white border-b border-gray-700 pb-2 mb-4';
            header.textContent = title;
            section.appendChild(header);

            endpoints.forEach((endpoint, index) => {
                const sectionId = `${id}-ep-${index}`;
                const methodClass = `method-${endpoint.method.toLowerCase()}`;
                
                const endpointHtml = `
                    <div class="api-section mb-6" data-section="${sectionId}">
                        <div class="bg-gray-800/50 rounded-lg">
                            <div class="section-header flex justify-between items-center p-4 cursor-pointer" onclick="toggleSection('${sectionId}')">
                                <div class="flex items-center gap-4 flex-wrap">
                                    <span class="${methodClass} font-mono text-sm font-semibold px-2.5 py-0.5 rounded-md">${endpoint.method}</span>
                                    <span class="text-lg font-semibold text-white font-fira">${endpoint.path}</span>
                                </div>
                                <svg class="w-5 h-5 text-gray-400 transition-transform flex-shrink-0 ml-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
                            </div>
                            <div class="section-content hidden p-4 border-t border-gray-700">
                                <p class="text-gray-300 mb-4">${endpoint.description}</p>
                                ${endpoint.body ? `
                                <h4 class="font-semibold text-white mb-2">Request Body</h4>
                                <div class="relative">
                                    <pre class="bg-gray-900 rounded-lg p-4 font-fira text-sm text-gray-200 overflow-x-auto"><code class="language-json" id="${sectionId}-body">${endpoint.body}</code></pre>
                                    <button onclick="copyToClipboard('${sectionId}-body')" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs px-2 py-1 rounded">Copy</button>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
                section.innerHTML += endpointHtml;
            });

            return section;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('api-sections-container');
            container.appendChild(createApiSection('admin', 'Admin API', apiData.admin));
            container.appendChild(createApiSection('coach', 'Coach API', apiData.coach));
            container.appendChild(createApiSection('player', 'Player API', apiData.player));
            
            // Auto-open the first section of each API group by default
            toggleSection('login');
        });

        function toggleSection(sectionId) {
            const section = document.querySelector(`.api-section[data-section="${sectionId}"]`);
            if (section) {
                const content = section.querySelector('.section-content');
                const header = section.querySelector('.section-header');
                
                section.classList.toggle('section-open');
                content.classList.toggle('hidden');
            }
        }
        
        function copyToClipboard(elementId) {
            const textToCopy = document.getElementById(elementId).innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = textToCopy;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                document.execCommand('copy');
                // Maybe add a temporary "Copied!" message
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            document.body.removeChild(tempTextArea);
        }
    </script>
</body>
</html>
